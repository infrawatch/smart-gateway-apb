FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHNtYXJ0LWdhdGV3YXktYXBiCmRlc2NyaXB0aW9uOiBTbWFydCBH\
YXRld2F5IGZvciBwcm92aWRpbmcgbWV0cmljcyBhbmQgZXZlbnRzIGZyb20gYW4gQU1RUCAxLngg\
YnVzCmJpbmRhYmxlOiBGYWxzZQphc3luYzogb3B0aW9uYWwKbWV0YWRhdGE6CiAgZGlzcGxheU5h\
bWU6IFNtYXJ0IEdhdGV3YXkgKEFQQikKICBwcm92aWRlckRpc3BsYXlOYW1lOiAiUmVkIEhhdCwg\
SW5jLiIKcGxhbnM6CiAgLSBuYW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogVGhpcyBkZWZh\
dWx0IHBsYW4gZGVwbG95cyB0aGUgU21hcnQgR2F0ZXdheQogICAgZnJlZTogVHJ1ZQogICAgbWV0\
YWRhdGE6CiAgICAgICAgZGlzcGxheU5hbWU6IERlZmF1bHQKICAgIHBhcmFtZXRlcnM6CiAgICAg\
ICAgLSBuYW1lOiBzZ190eXBlCiAgICAgICAgICB0aXRsZTogVHlwZSBvZiBTbWFydCBHYXRld2F5\
IHRvIGRlcGxveQogICAgICAgICAgdHlwZTogZW51bQogICAgICAgICAgZW51bTogWydtZXRyaWNz\
JywgJ2V2ZW50cyddCiAgICAgICAgICBkZWZhdWx0OiBtZXRyaWNzCiAgICAgICAgICByZXF1aXJl\
ZDogdHJ1ZQogICAgICAgIC0gbmFtZTogc2dfbGFiZWwKICAgICAgICAgIHRpdGxlOiBVbmlxdWUg\
bGFiZWwgZm9yIFNtYXJ0IEdhdGV3YXkKICAgICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgICAg\
ZGlzcGxheV90eXBlOiB0ZXh0CiAgICAgICAgICBkZWZhdWx0OiAiYmx1ZSIKICAgICAgICAgIHJl\
cXVpcmVkOiB0cnVlCgo="

COPY playbooks/* /opt/apb/project/
COPY roles/smart_gateway /opt/apb/project/roles/smart_gateway
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
